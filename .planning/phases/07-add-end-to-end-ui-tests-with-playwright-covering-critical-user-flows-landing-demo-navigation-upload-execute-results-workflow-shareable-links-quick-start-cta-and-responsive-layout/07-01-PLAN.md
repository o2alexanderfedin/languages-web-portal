---
phase: 07-e2e-testing
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - playwright.config.ts
  - package.json
  - .gitignore
  - packages/client/src/pages/Landing.tsx
  - packages/client/src/pages/Home.tsx
  - packages/client/src/features/landing/HeroSection.tsx
  - packages/client/src/features/landing/ToolComparisonGrid.tsx
  - packages/client/src/features/landing/QuickStartCTA.tsx
  - packages/client/src/features/upload/UploadZone.tsx
  - packages/client/src/features/execution/ToolPicker.tsx
  - packages/client/src/features/execution/ExecutionPanel.tsx
  - packages/client/src/features/execution/ConsoleView.tsx
  - packages/client/src/features/output/OutputPanel.tsx
  - packages/client/src/features/output/DownloadButton.tsx
  - packages/client/src/features/landing/ShareableLink.tsx
  - e2e/pages/LandingPage.ts
  - e2e/pages/DemoPage.ts
  - e2e/fixtures/test-files/sample.zip
  - e2e/fixtures/test-files/create-test-zip.ts
autonomous: true

must_haves:
  truths:
    - "Playwright is installed and configured with webServer pointing to localhost:3000"
    - "All interactive UI elements have data-testid attributes for stable test selectors"
    - "Page Object Models exist for LandingPage and DemoPage with typed locators"
    - "Test fixture ZIP file exists for upload testing"
    - "npx playwright test --list shows test infrastructure is working"
  artifacts:
    - path: "playwright.config.ts"
      provides: "Playwright configuration with desktop and mobile projects, webServer config"
      contains: "webServer"
    - path: "e2e/pages/LandingPage.ts"
      provides: "Landing page POM with navigation and CTA methods"
      exports: ["LandingPage"]
    - path: "e2e/pages/DemoPage.ts"
      provides: "Demo page POM with upload, execute, download methods"
      exports: ["DemoPage"]
    - path: "e2e/fixtures/test-files/sample.zip"
      provides: "Valid ZIP with small .cpp file for upload testing"
  key_links:
    - from: "e2e/pages/LandingPage.ts"
      to: "packages/client/src/pages/Landing.tsx"
      via: "data-testid attributes"
      pattern: "data-testid"
    - from: "e2e/pages/DemoPage.ts"
      to: "packages/client/src/pages/Home.tsx"
      via: "data-testid attributes"
      pattern: "data-testid"
---

<objective>
Install Playwright, add data-testid attributes to all key interactive elements, create Page Object Models for Landing and Demo pages, and prepare test fixture files.

Purpose: Establish the E2E testing infrastructure so Plan 02 can write focused test specs without setup overhead.
Output: Working Playwright config, POMs with typed locators, and test fixture ZIP file.
</objective>

<execution_context>
@/Users/alexanderfedin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/alexanderfedin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-add-end-to-end-ui-tests-with-playwright-covering-critical-user-flows-landing-demo-navigation-upload-execute-results-workflow-shareable-links-quick-start-cta-and-responsive-layout/07-RESEARCH.md
@packages/client/src/pages/Landing.tsx
@packages/client/src/pages/Home.tsx
@packages/client/src/features/landing/HeroSection.tsx
@packages/client/src/features/landing/ToolComparisonGrid.tsx
@packages/client/src/features/landing/QuickStartCTA.tsx
@packages/client/src/features/upload/UploadZone.tsx
@packages/client/src/features/execution/ToolPicker.tsx
@packages/client/src/features/execution/ExecutionPanel.tsx
@packages/client/src/features/execution/ConsoleView.tsx
@packages/client/src/features/output/OutputPanel.tsx
@packages/client/src/features/output/DownloadButton.tsx
@packages/client/src/features/landing/ShareableLink.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Playwright and add data-testid attributes to components</name>
  <files>
    package.json
    playwright.config.ts
    .gitignore
    packages/client/src/pages/Landing.tsx
    packages/client/src/pages/Home.tsx
    packages/client/src/features/landing/HeroSection.tsx
    packages/client/src/features/landing/ToolComparisonGrid.tsx
    packages/client/src/features/landing/QuickStartCTA.tsx
    packages/client/src/features/upload/UploadZone.tsx
    packages/client/src/features/execution/ToolPicker.tsx
    packages/client/src/features/execution/ExecutionPanel.tsx
    packages/client/src/features/execution/ConsoleView.tsx
    packages/client/src/features/output/OutputPanel.tsx
    packages/client/src/features/output/DownloadButton.tsx
    packages/client/src/features/landing/ShareableLink.tsx
  </files>
  <action>
    1. Install @playwright/test as devDependency at root: `npm install -D @playwright/test`
    2. Install Playwright browsers: `npx playwright install --with-deps chromium` (only Chromium — keep CI fast)
    3. Add scripts to root package.json:
       - "test:e2e": "playwright test"
       - "test:e2e:ui": "playwright test --ui"
       - "test:e2e:report": "playwright show-report"
    4. Create playwright.config.ts at project root with:
       - testDir: './e2e/tests'
       - fullyParallel: true
       - forbidOnly: !!process.env.CI
       - retries: process.env.CI ? 2 : 0
       - workers: process.env.CI ? 1 : undefined
       - reporter: [['html'], ['list']]
       - use.baseURL: 'http://localhost:3000'
       - use.trace: 'on-first-retry'
       - use.screenshot: 'only-on-failure'
       - Two projects: 'desktop' (viewport 1280x720, Desktop Chrome) and 'mobile' (iPhone 13 Pro)
       - webServer: { command: 'npm run dev', url: 'http://localhost:3000', reuseExistingServer: !process.env.CI, timeout: 120_000 }
    5. Add to .gitignore: /test-results/, /playwright-report/, /blob-report/, /playwright/.cache/
    6. Add data-testid attributes to ALL key interactive elements in React components. Use this naming convention: `data-testid="component-element"`. Specifically:
       - Landing.tsx: data-testid="landing-page" on root div, data-testid="landing-footer-demo-link" on "Try the Demo" link
       - HeroSection.tsx: data-testid="hero-section", data-testid="hero-quickstart-cta" on QuickStartCTA wrapper, data-testid="hero-explore-tools" on Explore Tools button
       - ToolComparisonGrid.tsx: data-testid="tool-comparison-grid", data-testid="tool-comparison-table" on desktop table, data-testid="tool-comparison-cards" on mobile card container, data-testid={`tool-row-${tool.id}`} on each table row, data-testid={`tool-card-${tool.id}`} on each mobile card, data-testid={`tool-try-now-${tool.id}`} on each Try Now button
       - QuickStartCTA.tsx: data-testid="quickstart-cta" on Button
       - Home.tsx: data-testid="demo-page" on root div, data-testid="back-to-home" on Back to Home link, data-testid="upload-section" on upload section div, data-testid="execution-section" on execution section div, data-testid="share-section" on share section div
       - UploadZone.tsx: data-testid="upload-zone" on the dropzone div (the one with getRootProps), data-testid="upload-status" on the status display area, data-testid="upload-success" on the success state div, data-testid="upload-error" on the error state div
       - ToolPicker.tsx: data-testid="tool-picker" on root grid div, data-testid={`tool-option-${tool.id}`} on each tool card
       - ExecutionPanel.tsx: data-testid="execution-panel" on root, data-testid="execute-button" on the run/execute button
       - ConsoleView.tsx: data-testid="console-output" on the console output container
       - OutputPanel.tsx: data-testid="output-panel" on root
       - DownloadButton.tsx: data-testid="download-button" on the download link/button
       - ShareableLink.tsx: data-testid="shareable-link" on root
    7. Verify no existing unit tests break: `npm test` must still pass
    8. Verify lint passes: `npm run lint`
  </action>
  <verify>
    - `npx playwright --version` returns a version number
    - `npm test` (vitest) still passes — data-testid attributes don't break existing tests
    - `grep -r "data-testid" packages/client/src/` shows attributes on all key components
    - `npm run lint` passes
  </verify>
  <done>
    Playwright installed, configured with desktop+mobile projects and webServer auto-start. All key interactive UI elements have data-testid attributes. Existing unit tests unaffected.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Page Object Models and test fixture files</name>
  <files>
    e2e/pages/LandingPage.ts
    e2e/pages/DemoPage.ts
    e2e/fixtures/test-files/create-test-zip.ts
    e2e/fixtures/test-files/sample.zip
  </files>
  <action>
    1. Create e2e/pages/LandingPage.ts — Page Object Model with:
       - Constructor accepting Page, setting up locators for: heroSection, heroTitle (getByRole heading with "Formal Verification"), quickStartButton (data-testid="quickstart-cta"), exploreToolsButton (data-testid="hero-explore-tools"), toolComparisonGrid (data-testid="tool-comparison-grid"), toolTable (data-testid="tool-comparison-table"), toolCards (data-testid="tool-comparison-cards"), footerDemoLink (data-testid="landing-footer-demo-link")
       - goto() method: navigates to '/'
       - clickQuickStart() method: clicks quickstart CTA, waits for URL to contain '/demo'
       - clickTryNow(toolId: string) method: clicks the Try Now button for the specified tool (data-testid=`tool-try-now-${toolId}`), waits for URL to contain '/demo'
       - clickExploreTools() method: clicks Explore Tools button
       - navigateToDemo() method: clicks footer demo link, waits for '/demo' URL
       - getToolRow(toolId: string) method: returns locator for data-testid=`tool-row-${toolId}`
       - getToolCard(toolId: string) method: returns locator for data-testid=`tool-card-${toolId}`

    2. Create e2e/pages/DemoPage.ts — Page Object Model with:
       - Constructor accepting Page, setting up locators for: uploadZone (data-testid="upload-zone"), fileInput (input[type="file"]), uploadSuccess (data-testid="upload-success"), executionPanel (data-testid="execution-panel"), executeButton (data-testid="execute-button"), consoleOutput (data-testid="console-output"), outputPanel (data-testid="output-panel"), downloadButton (data-testid="download-button"), shareableLink (data-testid="shareable-link"), backToHome (data-testid="back-to-home"), toolPicker (data-testid="tool-picker")
       - goto(params?: string) method: navigates to '/demo' or '/demo?{params}'
       - uploadFile(filePath: string) method: sets file on hidden input via setInputFiles()
       - waitForUploadSuccess() method: waits for upload-success testid to be visible
       - selectTool(toolId: string) method: clicks tool-option-{toolId}
       - execute() method: clicks execute button
       - waitForExecutionComplete() method: waits for console output to contain "completed" or "exit code" (case insensitive), with extended timeout of 30s
       - getToolOption(toolId: string) method: returns locator for data-testid=`tool-option-${toolId}`

    3. Create e2e/fixtures/test-files/create-test-zip.ts — Node.js script that creates sample.zip:
       - Use archiver (already in project devDeps) to create a ZIP containing a single file `main.cpp` with:
         ```cpp
         #include <stdio.h>
         int main() {
             printf("Hello from test\n");
             return 0;
         }
         ```
       - Write to e2e/fixtures/test-files/sample.zip
       - Run this script immediately after creating it to generate the ZIP: `npx tsx e2e/fixtures/test-files/create-test-zip.ts`
       - If archiver is not available at root level, use Node.js built-in zlib + custom ZIP creation, or install archiver as devDep at root

    4. Verify the test infrastructure works by creating a minimal smoke test at e2e/tests/smoke.spec.ts:
       ```typescript
       import { test, expect } from '@playwright/test';
       test('smoke: app loads', async ({ page }) => {
         await page.goto('/');
         await expect(page).toHaveTitle(/.*/)
       });
       ```
       Run `npx playwright test smoke.spec.ts` to verify the entire pipeline works (webServer starts, browser launches, test passes). Then delete the smoke test file — it was only to validate infrastructure.

    5. If the smoke test reveals issues (webServer startup, port conflicts, etc.), fix them before proceeding.
  </action>
  <verify>
    - `ls e2e/pages/LandingPage.ts e2e/pages/DemoPage.ts` — both files exist
    - `ls e2e/fixtures/test-files/sample.zip` — fixture ZIP exists
    - `npx playwright test --list 2>&1 | head -5` — shows test list (even if empty after removing smoke test, no errors)
    - `npx tsc --noEmit e2e/pages/LandingPage.ts e2e/pages/DemoPage.ts 2>&1` — TypeScript compiles (or verify via direct import in a test)
  </verify>
  <done>
    LandingPage and DemoPage POMs created with typed locators matching data-testid attributes. Test fixture sample.zip exists. Playwright infrastructure validated via smoke test.
  </done>
</task>

</tasks>

<verification>
- Playwright installed and `npx playwright --version` works
- `playwright.config.ts` exists with webServer, desktop, and mobile projects
- All key components have data-testid attributes (grep confirms 15+ attributes across components)
- LandingPage.ts and DemoPage.ts POMs exist with exported classes
- sample.zip test fixture exists and is a valid ZIP
- Existing vitest unit tests still pass
- ESLint passes on modified files
</verification>

<success_criteria>
- `npm test` passes (existing tests unbroken)
- `npx playwright test --list` runs without errors
- Page Object Models compile and export correctly
- Test fixture ZIP file is valid and contains a .cpp file
- data-testid attributes present on all interactive elements listed in task 1
</success_criteria>

<output>
After completion, create `.planning/phases/07-add-end-to-end-ui-tests-with-playwright-covering-critical-user-flows-landing-demo-navigation-upload-execute-results-workflow-shareable-links-quick-start-cta-and-responsive-layout/07-01-SUMMARY.md`
</output>
